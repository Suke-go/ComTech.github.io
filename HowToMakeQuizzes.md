# 📚 問題作成ガイドライン

## 🎯 はじめに
このガイドラインは、スキマ時間クイズアプリの問題作成者向けの手引きです。効果的な学習教材を作成するための形式、記法、ベストプラクティスをまとめています。

## 📝 JSONファイルの基本構造

### 必須フィールド
```json
{
  "questions": [
    {
      "id": 1,
      "question": "問題文",
      "choices": ["選択肢1", "選択肢2", "選択肢3", "選択肢4", "わからない"],
      "correct": 0,
      "explanation": "解説文"
    }
  ]
}
```

### フィールド説明
- **id**: 問題の識別番号（整数）
- **question**: 問題文（HTML・数式可）
- **choices**: 選択肢の配列（必ず最後に「わからない」を含める）
- **correct**: 正解の選択肢のインデックス（0から開始）
- **explanation**: 不正解時に表示される解説

## 🔢 数式の記法

### 基本的な数式記法

| 用途 | 記法 | 例 | 表示結果 |
|------|------|-----|----------|
| ディスプレイ数式（中央・大） | `$$...$$` | `$$x^2 + y^2 = r^2$$` | 円の方程式（中央に大きく） |
| インライン数式（文中） | `$...$` | `$x = 2$のとき` | x = 2のとき（文中に小さく） |
| 分数 | `\\frac{分子}{分母}` | `$$\\frac{a}{b}$$` | a/b |
| 上付き文字 | `^` | `$$x^2$$` | x² |
| 下付き文字 | `_` | `$$x_1$$` | x₁ |
| 平方根 | `\\sqrt{}` | `$$\\sqrt{x}$$` | √x |

### 高度な数式記法

```json
{
  "question": "次の積分を計算せよ：<br>$$\\int_0^{\\pi} \\sin x \\cos x \\, dx$$",
  "explanation": "$$\\begin{align} \\int_0^{\\pi} \\sin x \\cos x \\, dx &= \\frac{1}{2} \\int_0^{\\pi} \\sin 2x \\, dx \\\\ &= \\frac{1}{2} \\left[ -\\frac{1}{2} \\cos 2x \\right]_0^{\\pi} \\\\ &= 0 \\end{align}$$"
}
```

### よく使う数式コマンド

| 記号 | LaTeXコマンド | 用途 |
|------|--------------|------|
| ∫ | `\\int` | 積分 |
| ∑ | `\\sum` | 総和 |
| ∏ | `\\prod` | 総乗 |
| ∞ | `\\infty` | 無限大 |
| ∂ | `\\partial` | 偏微分 |
| ∇ | `\\nabla` | ナブラ |
| ± | `\\pm` | プラスマイナス |
| ≤ | `\\leq` | 以下 |
| ≥ | `\\geq` | 以上 |
| ≠ | `\\neq` | 等しくない |
| ≈ | `\\approx` | 近似的に等しい |
| → | `\\to` または `\\rightarrow` | 矢印 |
| ⇒ | `\\Rightarrow` | 二重矢印 |

## 📋 問題作成のベストプラクティス

### 1. 問題文の書き方
```json
{
  "question": "次の微分方程式を解け：<br>$$\\frac{d^2y}{dx^2} + 4\\frac{dy}{dx} + 3y = 0$$<br>初期条件：$y(0) = 1$, $y'(0) = 0$"
}
```
- 問題の種類を明確に（「次の〜を解け」「〜を求めよ」）
- 複雑な問題は`<br>`で適切に改行
- 初期条件や制約条件は明記

### 2. 選択肢の設計
```json
{
  "choices": [
    "$$y = \\frac{1}{2}e^{-x} + \\frac{1}{2}e^{-3x}$$",  // 正解
    "$$y = e^{-x} + e^{-3x}$$",                          // よくある計算ミス
    "$$y = \\frac{1}{2}e^{x} + \\frac{1}{2}e^{3x}$$",   // 符号ミス
    "$$y = e^{-2x}$$",                                   // 重解と勘違い
    "わからない"
  ]
}
```
- 正解以外の選択肢は「よくある間違い」を含める
- 単なるランダムな値ではなく、教育的な誤答を用意
- 必ず最後に「わからない」を配置

### 3. 解説の書き方
```json
{
  "explanation": "特性方程式を立てると：<br>$$r^2 + 4r + 3 = 0$$<br>これを解くと $(r+1)(r+3) = 0$ より $r = -1, -3$<br><br>一般解は：$$y = C_1 e^{-x} + C_2 e^{-3x}$$<br><br>初期条件を適用すると $C_1 = C_2 = \\frac{1}{2}$"
}
```
- ステップバイステップで解法を説明
- 重要な式変形は省略しない
- 適切な改行で読みやすくする

## 🎨 HTML要素の活用

### 利用可能なHTML要素
```json
{
  "question": "以下の<strong>重要な公式</strong>を覚えてください：<br><ul><li>運動エネルギー：$K = \\frac{1}{2}mv^2$</li><li>位置エネルギー：$U = mgh$</li></ul>"
}
```

- `<br>`: 改行
- `<strong>`: 強調（太字）
- `<em>`: 斜体
- `<ul>`, `<li>`: 箇条書き
- `<sup>`, `<sub>`: 上付き・下付き（数式外で使用）

## 📊 問題セットの構成

### 推奨される問題構成
1. **導入問題（20%）**: 基本概念の確認
2. **標準問題（50%）**: 主要な解法パターン
3. **応用問題（20%）**: 複数の概念を組み合わせ
4. **チャレンジ問題（10%）**: 発展的な内容

### 難易度の目安
- 10分で10-15問程度が解けるように設計
- 1問あたり30秒-1分で解答可能な難易度

## 🔍 よくある記法ミスと対処法

### ❌ 間違い → ⭕ 正しい記法

1. **バックスラッシュのエスケープ忘れ**
   - ❌ `\frac{1}{2}`
   - ⭕ `\\frac{1}{2}`

2. **中括弧の不足**
   - ❌ `x^12`（x¹²ではなくx¹·2と表示される）
   - ⭕ `x^{12}`

3. **積分の微分記号**
   - ❌ `\\int f(x)dx`
   - ⭕ `\\int f(x) \\, dx`（\\,で適切な間隔）

4. **改行タグの位置**
   - ❌ `$$式$$<br>`（数式の後に改行）
   - ⭕ `<br>$$式$$`（改行の後に数式）

## 💡 効果的な問題作成のコツ

### 1. 段階的な学習を意識
```json
[
  {
    "question": "微分の定義：$\\frac{d}{dx}x^n = ?$",
    "explanation": "基本公式：$\\frac{d}{dx}x^n = nx^{n-1}$"
  },
  {
    "question": "では、$\\frac{d}{dx}(3x^2 + 2x) = ?$",
    "explanation": "各項に公式を適用：$6x + 2$"
  }
]
```

### 2. 視覚的にわかりやすく
- 長い式は適切に改行
- 重要な部分は`<strong>`で強調
- 複雑な計算過程は段階的に表示

### 3. エラーを学習機会に
- 解説では「なぜ間違えやすいか」も説明
- 類似問題との違いを明確に
- 次回間違えないためのポイントを提示

## 📁 サンプルファイル

完全なサンプル（`questions_sample.json`）:
```json
{
  "questions": [
    {
      "id": 1,
      "question": "ニュートンの運動方程式 $F = ma$ において、<br>質量 $m = 2\\text{kg}$ の物体に $F = 10\\text{N}$ の力を加えたときの加速度は？",
      "choices": [
        "$5 \\text{m/s}^2$",
        "$20 \\text{m/s}^2$",
        "$0.2 \\text{m/s}^2$",
        "$12 \\text{m/s}^2$",
        "わからない"
      ],
      "correct": 0,
      "explanation": "$F = ma$ より $a = \\frac{F}{m} = \\frac{10}{2} = 5 \\text{m/s}^2$<br><br>単位も忘れずに確認しましょう。"
    }
  ]
}
```

## 🚀 問題作成を始める

1. テンプレートファイルをコピー
2. 分野・単元ごとにファイルを分割
3. 少しずつ問題を追加してテスト
4. 学習者のフィードバックを反映

---

**質問や提案があれば、お気軽にご連絡ください。**
より良い学習体験のために、一緒に素晴らしい問題を作成しましょう！🎓
